<div class="navbar">
    <div id="header" class="navbar-inner">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </a>
        <a id="logo" class="brand" href="/">Dunia</a>

        <form id="form">
            <?php echo $this->form->location; ?>
            <div style="margin-left: 300px; margin-top:-30px; width: 200px;">
            <fieldset style="border: none; margin: 0px; padding: 0px;">
                <label for="valueA" style="display:none;">From:</label>
                <select name="valueA" id="valueA" style="display:none;">
                    <option value="9:00" selected="selected">9:00</option>
                    <option value="10:00">10:00</option>
                    <option value="11:00">11:00</option>
                    <option value="12:00">Noon</option>
                    <option value="13:00">13:00</option>
                    <option value="14:00">14:00</option>
                    <option value="15:00">15:00</option>
                    <option value="16:00">16:00</option>
                    <option value="17:00">17:00</option>
                    <option value="18:00">18:00</option>
                    <option value="19:00">19:00</option>
                    <option value="20:00">20:00</option>
                    <option value="21:00">21:00</option>
                    <option value="22:00">22:00</option>
                    <option value="23:00">23:00</option>
                    <option value="24:00">24:00</option>
                </select>

                <label for="valueB" style="display:none;">To:</label>
                <select name="valueB" id="valueB" style="display:none;">
                    <option value="9:00">9:00</option>
                    <option value="10:00">10:00</option>
                    <option value="11:00">11:00</option>
                    <option value="12:00">Noon</option>
                    <option value="13:00">13:00</option>
                    <option value="14:00">14:00</option>
                    <option value="15:00">15:00</option>
                    <option value="16:00">16:00</option>
                    <option value="17:00">17:00</option>
                    <option value="18:00">18:00</option>
                    <option value="19:00">19:00</option>
                    <option value="20:00">20:00</option>
                    <option value="21:00">21:00</option>
                    <option value="22:00">22:00</option>
                    <option value="23:00">23:00</option>
                    <option value="24:00" selected="selected">24:00</option>
                </select>
            </fieldset>
            </div>
        </form>
        <?php echo $this->render('partials/nav.phtml'); ?>
    </div>
</div>
<div id="map_canvas" style="margin-top:-20px;height:95%;"></div>

<div id="bottom-info-bar">
	<div class="left summary" id="summary-bar">
		<script type="text/x-handlebars"  data-template-name="summary-bar">
		{{#each summaries}}
    		<a href="#" {{action "toggle"}}><img src="{{unbound smallIcon}}" />{{title}}: {{count}}</a>
		{{/each}}
		</script>
	</div>
	<div class="left">
        <?php echo $this->partial('partials/addthis.phtml'); ?>
	</div>
</div>

<div style="display:none">
	<div id="advanced-filter" style="margin-top: 18px; margin-right: -5px; direction: ltr; overflow: hidden; text-align: left; position: relative; color: rgb(0, 0, 0); font-family: Arial,sans-serif; -moz-user-select: none; font-size: 13px; background: none repeat scroll 0% 0% rgb(255, 255, 255); padding: 1px 6px; border: 1px solid rgb(113, 123, 135); box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.4); min-width: 28px;" title="I like ...">
        Pub Type
		<ul style="text-align: left" id="category-list">
		    <?php foreach($this->categories as $index => $value): ?>
    			<li><input id="category<?php echo $index; ?>" type="checkbox" value="<?php echo $index; ?>"/>
                    <label for="category<?php echo $index; ?>"><?php echo $value; ?></label>
                </li>
		    <?php endforeach; ?>
		</ul>
	</div>
</div>

<script type="text/javascript">

$(document).ready(function() {

	$('select#valueA, select#valueB').selectToUISlider({
		labels: 6,
		tooltip: false,
		sliderOptions: {
			stop: function() {
				var value0 = $('select#valueA').val();
				var value1 = $('select#valueB').val();
				AppMap.setMarkersByTime(value0, value1);
			}
		}
	});

    var amHere = new google.maps.LatLng('<?php echo $this->lat; ?>', '<?php echo $this->long; ?>');
    var myOptions = {
        zoom: <?php echo $this->zoom; ?>,
        maxZoom: 20,
        center: amHere,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        streetViewControl: true,
        overviewMapControl: true
    };


    AppMap = Dunia.Map.create({
        longitude: '<?php echo $this->long; ?>',
        latitude:  '<?php echo $this->lat; ?>',
        map:       new google.maps.Map(document.getElementById("map_canvas"), myOptions)
    });


    $control = $("#advanced-filter").detach();

    // Push the control to the top right position on the map
    AppMap.map.controls[google.maps.ControlPosition.TOP_LEFT].push($control[0]);

    var input = document.getElementById('location');
    var autocomplete = new google.maps.places.Autocomplete(input);

    autocomplete.bindTo('bounds', AppMap.map);

	var view = Ember.View.create({
		templateName: 'summary-bar',
		summaries: Dunia.summary.summaries,
		toggle: function(event) {
			event.preventDefault();
			var object = event.context;

			object.set('flag', !(object.get('flag')));
			AppMap.setMarkersVisible(object.get('name'), object.get('flag'));
		}
	});

	view.appendTo('#summary-bar');

    google.maps.event.addListener(autocomplete, 'place_changed', function() {
        var place = autocomplete.getPlace();
        AppMap.cleanMarkers();
        AppMap.map.setCenter(place.geometry.location);
    });

    google.maps.event.addListener(AppMap.map, 'tilesloaded', function(event) {
    	AppMap.fetchBars();
    	$('#category-list li input[type="checkbox"]').click(function(e) {
    	    AppMap.chikaBowBow(this);
        });
    });

});
</script>


<?php $this->headScript()->appendFile('/contrib/selectToUiSlider/js/selectToUISlider.jQuery.js'); ?>
<?php $this->headLink()->appendStylesheet('/contrib/selectToUiSlider/css/ui.slider.extras.css'); ?>