<?php $address = $this->pub->address; ?>

<div class="container_12 content">

    <div class="grid_8">
        <h1><?php echo $this->pub->name; ?></h1>
        
        <?php 
            $days   = Model_Day::$daysName; 
            $promos = $this->pub->getPromosByDay();
        ?>
        <!-- <a href="/deal/add/idPub/<?php echo $this->pub->id; ?>">Add Deal</a> -->
        <table id="promos" class="generic" cellspacing="1px" cellpadding="0px" border="0">
            
            <thead>
                <tr>
                    <?php foreach ($days as $day): ?>
                        <th><?php echo $day; ?></th>
                    <?php endforeach; ?>
                </tr>
            </thead>
            <tbody>
                <tr>
                <?php foreach ($days as $dayInt => $day): ?>
                    <td width="<?php echo (1/sizeof($days)) * 100; ?>%">
                    <?php if (isset($promos[$dayInt])) {
                        foreach ($promos[$dayInt] as $promo): ?>
                            <div class="promo">
                                <div class="time">
                                    <?php echo $this->formatDate($promo->timeStart, 'H:i'); ?> - <?php echo $this->formatDate($promo->timeEnd, 'H:i'); ?>
                                </div>
                                <div class="promoContent"><strong><?php echo $this->currency($promo->price); ?></strong><br />
                                    <?php foreach ($promo->getLiquorTypes() as $liquor) {
                                        echo ' ' . $liquor->name;
                                        $size = $promo->getLiquorSizes();
                                        foreach ($size as $s) {
                                            echo ' (' . $s['name'] . ')';
                                        }
                                    } ?>
                                </div> 
                            </div>
                        <?php endforeach; ?>
                    <?php } ?>
                    </td>
                <?php endforeach; ?>
                </tr>
            </tbody>
        </table>
        
<!-- Remove this br crap -->
<br />        
<br />        
<br />        
<br />        
<!-- Remove this br crap -->

        <?php 
        $tips = $this->pub->getTips();
        if (count($tips)): ?>
        <table class="generic" cellspacing="1px" cellpadding="0px" border="0">
            <thead>
                <tr>
                    <th style="height: 20px">
                        <div class="left">
                            Tips
                        </div>
                        <div class="right">
                            <img src="/img/icons/social/poweredByFoursquare_gray.png" width="128" height="14" />    
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($tips as $tip) { ?>
                    <tr>
                        <td>
                            <?php echo $tip->text; ?>
                        </td>
                    </tr>
                <?php } ?>
            </tbody>
        </table>
            
        <?php endif;?>
        
    </div>

    <div class="grid_4 sidebar omega" style="width:310px">
        <div>
            <div id="map_canvas" style="width: 100%; height: 200px;"></div>
            <div class="contact">
                <span class="address"><?php echo $address->formatOutput(); ?></span>
    			<a href="<?php echo $this->pub->url; ?>"><?php echo $this->pub->url; ?></a>
    			<a href="mailto:<?php echo $this->pub->email; ?>"><?php echo $this->pub->email; ?></a>
    		</div>
        </div>
    </div>
</div>

<script type="text/javascript"
    src="http://maps.googleapis.com/maps/api/js?sensor=true&libraries=places">
</script>
<script type="text/javascript">

$(document).ready(function() {
 
    var center = new google.maps.LatLng(parseFloat(<?php echo $address->latitude; ?>), parseFloat(<?php echo $address->longitude; ?>));
    var myOptions = {
        zoom: 16,
        center: center,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    new google.maps.Marker({
        map: map,
        position: center    
    });

});
</script>